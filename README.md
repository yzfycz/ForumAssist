# ForumAssist

![Python](https://img.shields.io/badge/Python-3.8%2B-blue.svg)
![License](https://img.shields.io/badge/License-MIT-green.svg)
![Platform](https://img.shields.io/badge/Platform-Windows-orange.svg)

一个专为视障用户设计的无障碍论坛客户端，支持100%键盘操作。

## 特性

- 🔐 **多账户管理** - 支持每个论坛多个账户，密码AES加密存储，快速账户切换
- 🌐 **完整论坛功能** - 支持浏览、发帖、回复、私信等所有论坛功能
- ♿ **无障碍设计** - 100%键盘操作，专为视障用户优化，屏幕朗读器友好
- 🌳 **层级导航** - 树形论坛板块导航，支持多级分类展开/折叠
- 🔍 **智能搜索** - 快速搜索论坛内容和用户
- 💬 **消息系统** - 支持私信功能，消息隐私保护，HTML解析显示
- 🛡️ **安全认证** - 实时登录验证，会话信息内存存储
- 📊 **信息展示** - 优化的列表显示格式，完整的帖子信息展示
- 🔄 **分页支持** - 完善的分页功能，支持上下页跳转和指定页码
- 🖥️ **界面优化** - 程序启动自动最大化，更好的视觉体验
- 🎯 **焦点管理** - 智能焦点记忆和恢复，支持键盘光标位置记忆
- 🏷️ **标题统一** - 统一的窗口标题格式：论坛名字-<昵称>-论坛助手
- 📝 **楼层显示** - 正确的帖子楼层显示，支持多页帖子的实际楼层编号
- 🔍 **智能内容检测** - 子版块自动检测第一页有内容的页面，避免空白页面困扰

## 技术栈

- **语言**: Python 3.8+
- **GUI**: WxPython
- **网络**: requests
- **解析**: BeautifulSoup4
- **加密**: cryptography
- **配置**: configparser

## 安装

1. 克隆项目：
```bash
git clone https://github.com/yzfycz/ForumAssist.git
cd ForumAssist
```

2. 安装依赖：
```bash
pip install -r requirements.txt
```

3. 运行程序：
```bash
python main.py
```

## 使用说明

### 首次运行

1. 启动程序后，窗口会自动最大化显示
2. 如果没有配置账户，会自动显示账户管理界面
3. 点击"新建"添加你的论坛账户（默认选中争渡论坛）
4. 输入争渡号或邮箱和密码，系统会自动验证并获取用户信息
5. 添加成功后，在账户列表中选择账户回车即可登录使用

### 键盘快捷键

ForumAssist提供完整的键盘快捷键系统，为视障用户提供高效的无障碍操作体验。

#### 🎯 菜单快捷键

**主菜单访问**
- **Alt+F** - 打开文件菜单
- **Alt+H** - 打开帮助菜单

**文件菜单功能**
- **账户管理**
  - 方法一：Alt+F → M
  - 方法二：Ctrl+M（直接打开）

- **切换账户**
  - 方法一：Alt+F → Q
  - 方法二：Ctrl+Q（直接打开）

- **设置**
  - 方法一：Alt+F → P
  - 方法二：Ctrl+P（直接打开）

- **退出**
  - 方法一：Alt+F → X
  - 方法二：Alt+F4（系统标准）

**帮助菜单功能**
- **关于**
  - 方法一：Alt+H → A
  - 方法二：F1（直接打开）

#### 🔘 对话框按钮快捷键

**通用按钮（所有对话框）**
- **确定** - Alt+O
- **取消/关闭** - Alt+C
- **发送** - Alt+S

**账户管理对话框**
- **新建** - Ctrl+N（仅Ctrl快捷键，无Alt）
- **编辑** - Ctrl+E（仅Ctrl快捷键，无Alt）
- **删除** - Ctrl+D（仅Ctrl快捷键，无Alt）
- **关闭** - Alt+C

**消息相关对话框**
- **刷新** - Alt+R 或 F5
- **查看对话** - Alt+V

#### ⌨️ 基础操作快捷键

| 功能 | 快捷键 |
|------|--------|
| 激活菜单栏 | Alt |
| 控件间切换 | Tab |
| 确认/激活 | Enter |
| 关闭对话框 | Esc |
| 发送消息 | Ctrl+Enter |
| 刷新内容 | F5 |
| 返回上一级 | Backspace |
| 树节点展开/折叠 | 右方向键/左方向键 |
| 消息输入框换行 | Shift+Enter |

#### 🎮 上下文菜单快捷键

在帖子列表中选中帖子后，按Application键或右键可打开上下文菜单：

- **刷新** - F5
- **网页打开** - Ctrl+W
- **拷贝帖子标题** - Ctrl+C
- **拷贝帖子地址** - Ctrl+D

#### 🔧 快捷键设计原则

**易记性原则**
- **M** - Manage（管理）→ 账户管理
- **Q** - QieHuan（切换）→ 切换账户
- **P** - Preferences（设置）→ 设置
- **O** - OK（确定）→ 确认操作
- **C** - Cancel（取消）→ 取消/关闭
- **S** - Send（发送）→ 发送消息

**冲突避免**
- 避免与Windows系统快捷键冲突
- 不与常用读屏软件快捷键冲突
- 同一应用内快捷键不重复

**一致性原则**
- 所有确定按钮使用 Alt+O
- 所有取消按钮使用 Alt+C
- 所有发送按钮使用 Alt+S

#### 🚀 高效操作技巧

**常用操作组合**
1. **Ctrl+Q** → **方向键** → **Enter** - 快速切换账户
2. **Ctrl+M** → **Ctrl+N** → **Tab** → **输入信息** → **Alt+O** - 快速添加账户
3. **Ctrl+P** → **Tab** → **空格** → **Alt+O** - 快速更改设置

**导航技巧**
- 使用 Tab 键在界面元素间导航
- 使用方向键在列表中选择项目
- 使用 Enter 键确认选择或激活项目
- 使用 Esc 键取消操作或关闭对话框

#### 🎨 界面提示

所有支持快捷键的界面元素都会显示快捷键提示：

- 菜单项：`账户管理(&M) Ctrl+M`
- 按钮：`确定(&O)` 或 `发送(&S)`
- 账户管理：`新建 (Ctrl+N)`（无&符号，只有Ctrl快捷键）

### 界面布局

- **左侧**: 树形导航（最新发表、我的发表、我的回复、论坛板块层级结构）
- **右侧**: 内容列表（帖子列表、回复列表、消息对话等）
- **顶部**: 搜索框和功能按钮
- **底部**: 分页控制信息和状态栏

### 主要功能

#### 多账户管理
- 支持每个论坛添加多个账户
- 账户密码AES加密存储，安全可靠
- 通过文件菜单快速切换账户
- 防止同一论坛下重复用户名

#### 层级树形导航
- 显示论坛的完整层级结构（论坛→一级分类→二级分类）
- 支持树节点的展开和折叠操作
- 过滤无用的系统节点，只显示有效的论坛板块
- 屏幕朗读器友好，自动识别层级关系

#### 消息隐私保护
- 消息列表只显示用户名，隐藏消息内容
- 进入详细对话后才显示完整的消息内容
- 消息按时间顺序排列，最老的消息在最上面
- 支持HTML格式的消息解析和显示

#### 信息展示优化
- 统一的列表显示格式，包含完整的帖子信息
- 分页控制统一显示4个操作项
- 支持大数据量的分页浏览（我的回复支持116页）
- 列表宽度优化，确保信息完整显示

#### 焦点管理和导航优化
- 智能焦点记忆：进入帖子后返回，键盘光标从记忆位置继续浏览
- 屏幕阅读器友好：帖子详情自动朗读楼主内容
- 精确的页面恢复：支持返回到具体页面和位置
- 统一的标题格式：论坛名字-<昵称>-论坛助手

#### 帖子详情功能增强
- 完善的分页支持：修复多页帖子的分页显示问题
- 正确的楼层编号：第二页显示21楼、22楼等实际楼层
- 身份验证支持：添加auth参数确保完整内容访问
- 标题固定：进入帖子详情时标题保持不变

#### 子版块智能内容检测
- 自动检测第一页内容：当子版块第一页为空时，自动使用二分查找算法快速定位有内容的第一页
- 智能页面偏移：找到实际内容页面后，将其显示为"第1页"，避免用户困惑
- 高效算法：使用O(log n)时间复杂度的二分查找，快速定位内容页面
- 无缝体验：用户感知不到后台的页面跳转，只看到有内容的页面列表
- 分页逻辑完整：所有翻页操作（上一页、下一页、跳转）都正确处理页面偏移

## 项目结构

```
ForumAssist/
├── main.py                 # 程序入口
├── requirements.txt        # 依赖包
├── README.md              # 项目说明
├── .gitignore             # Git忽略文件
├── src/                   # 源代码
│   ├── main_frame.py      # 主窗口框架
│   ├── auth_manager.py    # 认证管理器
│   ├── forum_client.py    # 论坛客户端
│   ├── config_manager.py  # 配置管理器
│   ├── account_manager.py # 账户管理界面
│   ├── message_manager.py # 消息管理器
│   └── utils/            # 工具模块
│       ├── crypto.py     # 加密工具
│       └── html_parser.py# HTML解析
└── config/               # 配置目录
    └── api_config.py     # API配置
```

## 支持的论坛

目前支持争渡论坛(zd.hk)，未来将支持更多论坛。

## 开发计划

- [ ] 支持更多论坛平台
- [ ] 主题切换功能
- [ ] 语音提示功能
- [ ] 打包为可执行文件
- [ ] 自动更新功能
- [ ] 离线消息缓存
- [ ] 论坛通知推送
- [ ] 高级搜索功能
- [ ] 用户资料管理

## 贡献

欢迎提交Issue和Pull Request！

## 许可证

MIT License

## 致谢

感谢所有为无障碍事业做出贡献的开发者和用户。

---

**注意**: 本程序专为视障用户设计，请保持无障碍特性的完整性。